<!DOCTYPE html>
<!-- saved from url=(0043)http://www.angularjs.net.cn/tutorial/6.html -->
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>AngularJS 模块(Modules)</title>
<link rel="icon" href="http://www.angularjs.net.cn/Application/Home/View/Public/img/favicon.ico" type="image/x-icon">
<link rel="stylesheet" href="./16.AngularJS 模块(Modules)_files/bootstrap.min.css">
<link href="./16.AngularJS 模块(Modules)_files/prettify.css" rel="stylesheet">
<script src="./16.AngularJS 模块(Modules)_files/hm.js.下载"></script><script src="./16.AngularJS 模块(Modules)_files/prettify.js.下载"></script>


<link rel="stylesheet" href="./16.AngularJS 模块(Modules)_files/style.css">

</head>
<body onload="prettyPrint()">
<div id="top">
	<div class="container">
	<div class="logo"><a href="http://www.angularjs.net.cn/">AngularJs中文网</a></div>
	<ul>
		<li><a href="http://www.angularjs.net.cn/">首页</a></li>
		<li><a href="http://www.angularjs.net.cn/tutorial/">AngularJS 教程</a></li>
		
		<li><a href="http://www.angularjs.net.cn/phonecat/">AngularJS PhoneCat</a></li>
		<li><a href="http://www.angularjs.net.cn/download/">AngularJS 下载</a></li>
		<li><a href="http://www.angularjs.net.cn/api/">AngularJS api</a></li>
		<li style="display:none;"><a href="http://www.angularjs.net.cn/angular-seed">AngularJS Seed</a></li>
	<li><a href="https://promotion.aliyun.com/ntms/act/qwbk.html?userCode=iuvvbh9n" onclick="_hmt.push([&#39;_trackEvent&#39;, &#39;nav&#39;, &#39;click&#39;, &#39;Ecs&#39;])" target="_blank">Ecs服务器</a></li>
	

	
	</ul>
	</div>
</div>


<div class="container">
	<div class="row">
		<div class="col-md-3">
<ul>
	<li><a href="http://www.angularjs.net.cn/tutorial/1.html">简介（Introduction）</a></li><li><a href="http://www.angularjs.net.cn/tutorial/16.html">引导程序（Bootstrap）</a></li><li><a href="http://www.angularjs.net.cn/tutorial/18.html">概念概述(Conceptual Overview)</a></li><li><a href="http://www.angularjs.net.cn/tutorial/15.html">Html编译（HTML Compiler）</a></li><li><a href="http://www.angularjs.net.cn/tutorial/10.html">数据绑定（Data Binding）</a></li><li><a href="http://www.angularjs.net.cn/tutorial/2.html">控制器(Controllers)</a></li><li><a href="http://www.angularjs.net.cn/tutorial/19.html">服务（Services）</a></li><li><a href="http://www.angularjs.net.cn/tutorial/12.html">作用域(Scope)</a></li><li><a href="http://www.angularjs.net.cn/tutorial/17.html">依赖注入(Dependency Injection)</a></li><li><a href="http://www.angularjs.net.cn/tutorial/13.html">模板（Templates）</a></li><li><a href="http://www.angularjs.net.cn/tutorial/11.html">使用css(Working With CSS)</a></li><li><a href="http://www.angularjs.net.cn/tutorial/8.html">过滤器（Filters）</a></li><li><a href="http://www.angularjs.net.cn/tutorial/4.html">表单(Forms)</a></li><li><a href="http://www.angularjs.net.cn/tutorial/5.html">指令(Directives)</a></li><li><a href="http://www.angularjs.net.cn/tutorial/20.html">Components</a></li><li><a href="http://www.angularjs.net.cn/tutorial/21.html">Component Router</a></li><li><a href="http://www.angularjs.net.cn/tutorial/7.html">动画(Animations)</a></li><li><a href="http://www.angularjs.net.cn/tutorial/6.html">模块(Modules)</a></li><li><a href="http://www.angularjs.net.cn/tutorial/3.html">表达式(Expressions)</a></li><li><a href="http://www.angularjs.net.cn/tutorial/9.html">供应者（Providers）</a></li><li><a href="http://www.angularjs.net.cn/tutorial/14.html">$location</a></li><li><a href="http://www.angularjs.net.cn/tutorial/22.html">单元测试</a></li><li><a href="http://www.angularjs.net.cn/tutorial/23.html">端对端测试</a></li></ul>
<div id="ad">
<script async="" src="http://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<!-- 160x600 -->
<ins class="adsbygoogle" style="display:inline-block;width:160px;height:600px" data-ad-client="ca-pub-6117966252207595" data-ad-slot="1088261149"></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
</div>
</div>
		<div class="col-md-9">
			<div class="page-header"><h1>AngularJS 模块(Modules)</h1></div>

<div style="margin-bottom:10px;">
<script async="" src="http://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<!-- 728x90 --><ins class="adsbygoogle" style="display:inline-block;width:728px;height:90px" data-ad-client="ca-pub-6117966252207595" data-ad-slot="2639707541"></ins>
<script>(adsbygoogle = window.adsbygoogle || []).push({});</script>
<script async="" src="http://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<!-- 728x90 --><ins class="adsbygoogle" style="display:inline-block;width:728px;height:90px" data-ad-client="ca-pub-6117966252207595" data-ad-slot="2639707541"></ins>
<script>(adsbygoogle = window.adsbygoogle || []).push({});</script>
</div>
			
			<p>大多数应用程序都有个 <code><span class="pln">main</span></code> 函数来初始化、连接以及启动整个应用。ng 中虽然没有 <code><span class="pln">main</span></code> 函数，但它用模块来描述应用将如何启动。这种策略有如下几种优势：</p>
<ul>
<li>整个过程是声明式的，更容易理解</li>
<li>在单元测试中，没有必要加载所有模块，这样有利于单元测试的代码书写</li>
<li>在场景测试中，额外的模块可以被加载进来，进而重写一些配置，这样有助于实现应用的端到端的测试</li>
<li>第三方代码可以很容易被打包成可重用的模块</li>
<li>模块可以用任意顺序或并行顺序加载（得益于模块执行的延迟性）</li>
</ul>
<hr><h2>模块ABC</h2>
<p>你会说，别废话一箩筐了，说个 Hello World 的模块示例吧，让它跑起来才是王道呀。</p>

<ul>

<li>在 <code><span class="tag">&lt;html</span><span class="pln"> </span><span class="atn">ng-app</span><span class="pun">=</span><span class="atv">"myApp"</span><span class="tag">&gt;</span></code> ，注意对于 <code><span class="pln">myApp</span></code> 模块的引用，这是用模块的方法启动应用的触发点</li>
</ul>
<h3>源码</h3>

<div class="tabbable">

<ul class="nav nav-tabs" role="tablist">
	<li class="active"><a href="http://www.angularjs.net.cn/tutorial/6.html#index1" role="tab" data-toggle="tab">index.html</a></li>
	<li><a href="http://www.angularjs.net.cn/tutorial/6.html#script1" role="tab" data-toggle="tab">script.js</a></li>
	<li><a href="http://www.angularjs.net.cn/tutorial/6.html#protractor1" role="tab" data-toggle="tab">protractor.js</a></li>
</ul>

<div class="tab-content">
<div class="tab-pane active" id="index1">
<pre class="prettyprint linenums"><ol class="linenums"><li class="L0"><span class="dec">&lt;!doctype html&gt;</span></li><li class="L1"><span class="tag">&lt;html</span><span class="pln"> </span><span class="atn">ng-app</span><span class="pun">=</span><span class="atv">"myApp"</span><span class="tag">&gt;</span></li><li class="L2"><span class="pln">  </span><span class="tag">&lt;head&gt;</span></li><li class="L3"><span class="pln">    </span><span class="tag">&lt;script</span><span class="pln"> </span><span class="atn">src</span><span class="pun">=</span><span class="atv">"http://code.angularjs.org/1.2.25/angular.min.js"</span><span class="tag">&gt;&lt;/script&gt;</span></li><li class="L4"><span class="pln">    </span><span class="tag">&lt;script</span><span class="pln"> </span><span class="atn">src</span><span class="pun">=</span><span class="atv">"script.js"</span><span class="tag">&gt;&lt;/script&gt;</span></li><li class="L5"><span class="pln">  </span><span class="tag">&lt;/head&gt;</span></li><li class="L6"><span class="pln">  </span><span class="tag">&lt;body&gt;</span></li><li class="L7"><span class="pln">    </span><span class="tag">&lt;div&gt;</span></li><li class="L8"><span class="pln">      {{ 'World' | greet }}</span></li><li class="L9"><span class="pln">    </span><span class="tag">&lt;/div&gt;</span></li><li class="L0"><span class="pln">  </span><span class="tag">&lt;/body&gt;</span></li><li class="L1"><span class="tag">&lt;/html&gt;</span></li></ol></pre>
</div>
<div class="tab-pane" id="script1">
<pre class="prettyprint linenums"><ol class="linenums"><li class="L0"><span class="com">// declare a module</span></li><li class="L1"><span class="kwd">var</span><span class="pln"> myAppModule </span><span class="pun">=</span><span class="pln"> angular</span><span class="pun">.</span><span class="kwd">module</span><span class="pun">(</span><span class="str">'myApp'</span><span class="pun">,</span><span class="pln"> </span><span class="pun">[]);</span></li><li class="L2"><span class="pln">&nbsp;</span></li><li class="L3"><span class="com">// configure the module.</span></li><li class="L4"><span class="com">// in this example we will create a greeting filter</span></li><li class="L5"><span class="pln">myAppModule</span><span class="pun">.</span><span class="pln">filter</span><span class="pun">(</span><span class="str">'greet'</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">function</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span></li><li class="L6"><span class="pln"> </span><span class="kwd">return</span><span class="pln"> </span><span class="kwd">function</span><span class="pun">(</span><span class="pln">name</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span></li><li class="L7"><span class="pln">    </span><span class="kwd">return</span><span class="pln"> </span><span class="str">'Hello, '</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> name </span><span class="pun">+</span><span class="pln"> </span><span class="str">'!'</span><span class="pun">;</span></li><li class="L8"><span class="pln">  </span><span class="pun">};</span></li><li class="L9"><span class="pun">});</span></li></ol></pre>
</div>
<div class="tab-pane" id="protractor1">
<pre class="prettyprint linenums"><ol class="linenums"><li class="L0"><span class="pln">it</span><span class="pun">(</span><span class="str">'should add Hello to the name'</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">function</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span></li><li class="L1"><span class="pln">  expect</span><span class="pun">(</span><span class="pln">element</span><span class="pun">(</span><span class="kwd">by</span><span class="pun">.</span><span class="pln">binding</span><span class="pun">(</span><span class="str">"'World' | greet"</span><span class="pun">)).</span><span class="pln">getText</span><span class="pun">()).</span><span class="pln">toEqual</span><span class="pun">(</span><span class="str">'Hello, World!'</span><span class="pun">);</span></li><li class="L2"><span class="pun">});</span></li></ol></pre>
</div>
</div></div>

<h3 id="模块abc_demo">效果</h3>
<div class="well">
	<iframe src="./16.AngularJS 模块(Modules)_files/index.html"></iframe>
</div>
<hr><h2>推荐配置</h2>
<p>上面的例子太过简单了，对于大型应用显然不适用。对于大型应用，我们建议把它像这样分成多个模块：</p>
<ul>
<li>服务模块</li>
<li>指令模块</li>
<li>过滤器模块</li>
<li>一个应用的模块，依赖于上述的三个模块，而且包含应用的初始化及启动代码</li>
</ul>
<p>这样划分模块的原因主要是在你的测试中，经常需要忽略难以测试的初始化的代码，而且这样测试时可以单独加载模块进行相关的测试。</p>
<p>上述模块划分仅仅是一种建议性的方案，你可以根据自己的应用去调整。下面的代码显示了上面所述的模块划分：</p>
<h3>源码</h3>

<div class="tabbable">
<ul class="nav nav-tabs" role="tablist">
	<li class="active"><a href="http://www.angularjs.net.cn/tutorial/6.html#index2" role="tab" data-toggle="tab">index.html</a></li>
	<li><a href="http://www.angularjs.net.cn/tutorial/6.html#script2" role="tab" data-toggle="tab">script.js</a></li>
	<li><a href="http://www.angularjs.net.cn/tutorial/6.html#protractor2" role="tab" data-toggle="tab">protractor.js</a></li>
</ul>
<div class="tab-content">
<div class="tab-pane active" id="index2">
<pre class="prettyprint linenums"><ol class="linenums"><li class="L0"><span class="tag">&lt;body</span><span class="pln"> </span><span class="atn">ng-app</span><span class="pun">=</span><span class="atv">"xmpl"</span><span class="tag">&gt;</span><span class="pln">	</span></li><li class="L1"><span class="tag">&lt;div</span><span class="pln"> </span><span class="atn">ng-controller</span><span class="pun">=</span><span class="atv">"XmplController"</span><span class="tag">&gt;</span></li><li class="L2"><span class="pln">  {{ greeting }}</span></li><li class="L3"><span class="tag">&lt;/div&gt;</span></li><li class="L4"><span class="tag">&lt;/body&gt;</span></li></ol></pre>
</div>
<div class="tab-pane" id="script2">
<pre class="prettyprint linenums"><ol class="linenums"><li class="L0"><span class="pln">angular</span><span class="pun">.</span><span class="kwd">module</span><span class="pun">(</span><span class="str">'xmpl.service'</span><span class="pun">,</span><span class="pln"> </span><span class="pun">[])</span></li><li class="L1"><span class="pln">&nbsp;</span></li><li class="L2"><span class="pln">  </span><span class="pun">.</span><span class="pln">value</span><span class="pun">(</span><span class="str">'greeter'</span><span class="pun">,</span><span class="pln"> </span><span class="pun">{</span></li><li class="L3"><span class="pln">    salutation</span><span class="pun">:</span><span class="pln"> </span><span class="str">'Hello'</span><span class="pun">,</span></li><li class="L4"><span class="pln">    localize</span><span class="pun">:</span><span class="pln"> </span><span class="kwd">function</span><span class="pun">(</span><span class="pln">localization</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span></li><li class="L5"><span class="pln">      </span><span class="kwd">this</span><span class="pun">.</span><span class="pln">salutation </span><span class="pun">=</span><span class="pln"> localization</span><span class="pun">.</span><span class="pln">salutation</span><span class="pun">;</span></li><li class="L6"><span class="pln">    </span><span class="pun">},</span></li><li class="L7"><span class="pln">    greet</span><span class="pun">:</span><span class="pln"> </span><span class="kwd">function</span><span class="pun">(</span><span class="pln">name</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span></li><li class="L8"><span class="pln">      </span><span class="kwd">return</span><span class="pln"> </span><span class="kwd">this</span><span class="pun">.</span><span class="pln">salutation </span><span class="pun">+</span><span class="pln"> </span><span class="str">' '</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> name </span><span class="pun">+</span><span class="pln"> </span><span class="str">'!'</span><span class="pun">;</span></li><li class="L9"><span class="pln">    </span><span class="pun">}</span></li><li class="L0"><span class="pln">  </span><span class="pun">})</span></li><li class="L1"><span class="pln">&nbsp;</span></li><li class="L2"><span class="pln">  </span><span class="pun">.</span><span class="pln">value</span><span class="pun">(</span><span class="str">'user'</span><span class="pun">,</span><span class="pln"> </span><span class="pun">{</span></li><li class="L3"><span class="pln">    load</span><span class="pun">:</span><span class="pln"> </span><span class="kwd">function</span><span class="pun">(</span><span class="pln">name</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span></li><li class="L4"><span class="pln">      </span><span class="kwd">this</span><span class="pun">.</span><span class="pln">name </span><span class="pun">=</span><span class="pln"> name</span><span class="pun">;</span></li><li class="L5"><span class="pln">    </span><span class="pun">}</span></li><li class="L6"><span class="pln">  </span><span class="pun">});</span></li><li class="L7"><span class="pln">&nbsp;</span></li><li class="L8"><span class="pln">angular</span><span class="pun">.</span><span class="kwd">module</span><span class="pun">(</span><span class="str">'xmpl.directive'</span><span class="pun">,</span><span class="pln"> </span><span class="pun">[]);</span></li><li class="L9"><span class="pln">&nbsp;</span></li><li class="L0"><span class="pln">angular</span><span class="pun">.</span><span class="kwd">module</span><span class="pun">(</span><span class="str">'xmpl.filter'</span><span class="pun">,</span><span class="pln"> </span><span class="pun">[]);</span></li><li class="L1"><span class="pln">&nbsp;</span></li><li class="L2"><span class="pln">angular</span><span class="pun">.</span><span class="kwd">module</span><span class="pun">(</span><span class="str">'xmpl'</span><span class="pun">,</span><span class="pln"> </span><span class="pun">[</span><span class="str">'xmpl.service'</span><span class="pun">,</span><span class="pln"> </span><span class="str">'xmpl.directive'</span><span class="pun">,</span><span class="pln"> </span><span class="str">'xmpl.filter'</span><span class="pun">])</span></li><li class="L3"><span class="pln">&nbsp;</span></li><li class="L4"><span class="pln">  </span><span class="pun">.</span><span class="pln">run</span><span class="pun">(</span><span class="kwd">function</span><span class="pun">(</span><span class="pln">greeter</span><span class="pun">,</span><span class="pln"> user</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span></li><li class="L5"><span class="pln">    </span><span class="com">// This is effectively part of the main method initialization code</span></li><li class="L6"><span class="pln">    greeter</span><span class="pun">.</span><span class="pln">localize</span><span class="pun">({</span></li><li class="L7"><span class="pln">      salutation</span><span class="pun">:</span><span class="pln"> </span><span class="str">'Bonjour'</span></li><li class="L8"><span class="pln">    </span><span class="pun">});</span></li><li class="L9"><span class="pln">    user</span><span class="pun">.</span><span class="pln">load</span><span class="pun">(</span><span class="str">'World'</span><span class="pun">);</span></li><li class="L0"><span class="pln">  </span><span class="pun">})</span></li><li class="L1"><span class="pln">&nbsp;</span></li><li class="L2"><span class="pln">  </span><span class="pun">.</span><span class="pln">controller</span><span class="pun">(</span><span class="str">'XmplController'</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">function</span><span class="pun">(</span><span class="pln">$scope</span><span class="pun">,</span><span class="pln"> greeter</span><span class="pun">,</span><span class="pln"> user</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span></li><li class="L3"><span class="pln">    $scope</span><span class="pun">.</span><span class="pln">greeting </span><span class="pun">=</span><span class="pln"> greeter</span><span class="pun">.</span><span class="pln">greet</span><span class="pun">(</span><span class="pln">user</span><span class="pun">.</span><span class="pln">name</span><span class="pun">);</span></li><li class="L4"><span class="pln">  </span><span class="pun">});</span></li></ol></pre>

</div>
<div class="tab-pane" id="protractor2">
<pre class="prettyprint linenums"><ol class="linenums"><li class="L0"><span class="pln">it</span><span class="pun">(</span><span class="str">'should add Hello to the name'</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">function</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span></li><li class="L1"><span class="pln">  expect</span><span class="pun">(</span><span class="pln">element</span><span class="pun">(</span><span class="kwd">by</span><span class="pun">.</span><span class="pln">binding</span><span class="pun">(</span><span class="str">"greeting"</span><span class="pun">)).</span><span class="pln">getText</span><span class="pun">()).</span><span class="pln">toEqual</span><span class="pun">(</span><span class="str">'Bonjour World!'</span><span class="pun">);</span></li><li class="L2"><span class="pun">});</span></li></ol></pre>
</div>
</div>
</div>
<h3>效果</h3>
<div class="well">
	<iframe src="./16.AngularJS 模块(Modules)_files/index(1).html"></iframe>
</div>
<hr>
<h2>模块加载及依赖</h2>
<p>模块是配置代码块和运行代码块的集合，在启动阶段被执行。最简单的模块中包含下面两种代码块：</p>
<ol>
<li><strong>配置代码块</strong> - 在 <code>provider</code> 注册和配置阶段执行（注：provider 是 ng 服务的一种）。只有 <code>provider</code> 和 <code>constant</code> 可以被注入配置代码块。这是为了防止服务在完全配置好之前被意外地初始化。</li>
<li><strong>执行代码块</strong> - 在 <code>injector</code> 被创建后执行，被用来启动整个应用。只有服务的实例对象以及 <code>constant</code> 可以被注入到执行代码块。这是为了防止在应用执行期间系统的更进一步的配置。</li>
</ol>
<pre class="prettyprint linenums"><ol class="linenums"><li class="L0"><span class="pln">angular</span><span class="pun">.</span><span class="kwd">module</span><span class="pun">(</span><span class="str">'myModule'</span><span class="pun">,</span><span class="pln"> </span><span class="pun">[]).</span></li><li class="L1"><span class="pln">  config</span><span class="pun">(</span><span class="kwd">function</span><span class="pun">(</span><span class="pln">injectables</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> </span><span class="com">// provider型注入器</span></li><li class="L2"><span class="pln">    </span><span class="com">// 这是配置(config)代码块的范例，你可以有任意多个配置代码块</span></li><li class="L3"><span class="pln">    </span><span class="com">// 配置块中你只能注入Provider类（注意：不是由Provider类生成的实例）以及`constant`</span></li><li class="L4"><span class="pln">  </span><span class="pun">}).</span></li><li class="L5"><span class="pln">  run</span><span class="pun">(</span><span class="kwd">function</span><span class="pun">(</span><span class="pln">injectables</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> </span><span class="com">// instance型注入器</span></li><li class="L6"><span class="pln">    </span><span class="com">// 这是运行(run)代码块的范例，你可以有任意个运行代码块</span></li><li class="L7"><span class="pln">    </span><span class="com">// 运行块中你只能注入Provider实例（注意：不是Provider类）</span></li><li class="L8"><span class="pln">  </span><span class="pun">});</span></li></ol></pre>
<h3 id="模块加载及依赖_配置代码块">配置代码块</h3>
<p>有一些快捷方法可供模块调用，效果等同于配置代码块，比如：</p>
<pre class="prettyprint linenums"><ol class="linenums"><li class="L0"><span class="pln">angular</span><span class="pun">.</span><span class="kwd">module</span><span class="pun">(</span><span class="str">'myModule'</span><span class="pun">,</span><span class="pln"> </span><span class="pun">[]).</span></li><li class="L1"><span class="pln">  value</span><span class="pun">(</span><span class="str">'a'</span><span class="pun">,</span><span class="pln"> </span><span class="lit">123</span><span class="pun">).</span></li><li class="L2"><span class="pln">  factory</span><span class="pun">(</span><span class="str">'a'</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">function</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> </span><span class="kwd">return</span><span class="pln"> </span><span class="lit">123</span><span class="pun">;</span><span class="pln"> </span><span class="pun">}).</span></li><li class="L3"><span class="pln">  directive</span><span class="pun">(</span><span class="str">'directiveName'</span><span class="pun">,</span><span class="pln"> </span><span class="pun">...).</span></li><li class="L4"><span class="pln">  filter</span><span class="pun">(</span><span class="str">'filterName'</span><span class="pun">,</span><span class="pln"> </span><span class="pun">...);</span></li><li class="L5"><span class="pln">&nbsp;</span></li><li class="L6"><span class="com">// 等同于</span></li><li class="L7"><span class="pln">&nbsp;</span></li><li class="L8"><span class="pln">angular</span><span class="pun">.</span><span class="kwd">module</span><span class="pun">(</span><span class="str">'myModule'</span><span class="pun">,</span><span class="pln"> </span><span class="pun">[]).</span></li><li class="L9"><span class="pln">  config</span><span class="pun">(</span><span class="kwd">function</span><span class="pun">(</span><span class="pln">$provide</span><span class="pun">,</span><span class="pln"> $compileProvider</span><span class="pun">,</span><span class="pln"> $filterProvider</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span></li><li class="L0"><span class="pln">    $provide</span><span class="pun">.</span><span class="pln">value</span><span class="pun">(</span><span class="str">'a'</span><span class="pun">,</span><span class="pln"> </span><span class="lit">123</span><span class="pun">);</span></li><li class="L1"><span class="pln">    $provide</span><span class="pun">.</span><span class="pln">factory</span><span class="pun">(</span><span class="str">'a'</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">function</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> </span><span class="kwd">return</span><span class="pln"> </span><span class="lit">123</span><span class="pun">;</span><span class="pln"> </span><span class="pun">});</span></li><li class="L2"><span class="pln">    $compileProvider</span><span class="pun">.</span><span class="pln">directive</span><span class="pun">(</span><span class="str">'directiveName'</span><span class="pun">,</span><span class="pln"> </span><span class="pun">...);</span></li><li class="L3"><span class="pln">    $filterProvider</span><span class="pun">.</span><span class="kwd">register</span><span class="pun">(</span><span class="str">'filterName'</span><span class="pun">,</span><span class="pln"> </span><span class="pun">...);</span></li><li class="L4"><span class="pln">  </span><span class="pun">});</span></li></ol></pre>
<p>配置语句的执行顺序就是根据它们注册的顺序而定的。唯一的例外是 <code>constant</code> 的定义，它会被调整到所有配置块的最前面执行。</p>
<h3 id="模块加载及依赖_执行代码块">执行代码块</h3>
<p>执行代码块是 ng 中最接近 <code>main</code> 函数的一个东西。执行代码块是应用启动时运行的代码。它在所有的服务被配置好以及 <code>注入器(injector)</code> 被创建好之后执行。通常，执行代码块包含的代码都很难进行单元测试，正因为如此，它通常应该被丢在一个单独的模块中，这样我们可以在单元测试时忽略它。</p>
<h3 id="模块加载及依赖_模块依赖">模块依赖</h3>
<p>模块声明时可以列出它所需要依赖的其它模块。一个模块依赖某模块，意味着这个被依赖的模块需要在模块被加载之前加载完毕。更具体些，假设模块A依赖于模块B，那么模块A的配置代码块的执行，必须发生在模块B的配置代码块之后；模块A的执行代码块亦同理，也在模块B的执行代码块之后被执行。每个模块只能被加载一次，即使有多个别的模块依赖它。</p>
<h3 id="模块加载及依赖_异步加载">异步加载</h3>
<p>模块是一种管理 <code>$injector</code> 配置的方式，它和将脚本加载到JavaScript虚拟机（VM）没有半毛钱关系。现在已经有很多项目用来在 ng 中处理脚本的动态加载。由于模块在加载期什么都不做，所以它们可以按任何顺序载入到虚拟机中，脚本加载器也可以充分利用这一特性来并行地加载模块和脚本。</p>
<h3 id="模块加载及依赖_创建模块-vs-获取模块">创建模块 vs 获取模块</h3>
<p>注意，使用 <code>angular.module('myModule', [])</code> 将创建名为 <code>myModule</code> 的模块并重写已有的同名模块。而使用 <code>angular.module('myModule')</code> 则只会获取已有的模块实例。</p>
<pre class="prettyprint linenums"><ol class="linenums"><li class="L0"><span class="pln">  </span><span class="kwd">var</span><span class="pln"> myModule </span><span class="pun">=</span><span class="pln"> angular</span><span class="pun">.</span><span class="kwd">module</span><span class="pun">(</span><span class="str">'myModule'</span><span class="pun">,</span><span class="pln"> </span><span class="pun">[]);</span></li><li class="L1"><span class="pln">  </span></li><li class="L2"><span class="pln">  </span><span class="com">// 添加一些指令和服务</span></li><li class="L3"><span class="pln">  myModule</span><span class="pun">.</span><span class="pln">service</span><span class="pun">(</span><span class="str">'myService'</span><span class="pun">,</span><span class="pln"> </span><span class="pun">...);</span></li><li class="L4"><span class="pln">  myModule</span><span class="pun">.</span><span class="pln">directive</span><span class="pun">(</span><span class="str">'myDirective'</span><span class="pun">,</span><span class="pln"> </span><span class="pun">...);</span></li><li class="L5"><span class="pln">&nbsp;</span></li><li class="L6"><span class="pln">  </span><span class="com">// 创建一个新模块将覆盖掉这些指令和服务</span></li><li class="L7"><span class="pln">  </span><span class="kwd">var</span><span class="pln"> myModule </span><span class="pun">=</span><span class="pln"> angular</span><span class="pun">.</span><span class="kwd">module</span><span class="pun">(</span><span class="str">'myModule'</span><span class="pun">,</span><span class="pln"> </span><span class="pun">[]);</span></li><li class="L8"><span class="pln">&nbsp;</span></li><li class="L9"><span class="pln">  </span><span class="com">// 由于myOtherModule模块还没有定义，所以会抛出一个异常</span></li><li class="L0"><span class="pln">  </span><span class="kwd">var</span><span class="pln"> myModule </span><span class="pun">=</span><span class="pln"> angular</span><span class="pun">.</span><span class="kwd">module</span><span class="pun">(</span><span class="str">'myOtherModule'</span><span class="pun">);</span></li></ol></pre>
<hr><h2>单元测试</h2>
<p>单元测试最简单的形式是在测试容器中初始化应用的一小部分对象然后进行模拟运行。意识到每个模块在每个 <code>injector</code> 创建时只能被加载一次是非常重要的。通常每个应用中只有一个 <code>注入器(injector)</code>（译注：即全局单例），但是在测试中，每个测试容器都有自己的独立<code>injector</code> ，这意味着对于JS虚拟机，模块都会被多次加载。用正确的形式组织模块将有助于我们进行单元测试，如下面例子所示：</p>
<p>以下例子中，我们都会用到的模块定义如下：</p>
<pre class="prettyprint linenums"><ol class="linenums"><li class="L0"><span class="pln">  angular</span><span class="pun">.</span><span class="kwd">module</span><span class="pun">(</span><span class="str">'greetMod'</span><span class="pun">,</span><span class="pln"> </span><span class="pun">[]).</span></li><li class="L1"><span class="pln">&nbsp;</span></li><li class="L2"><span class="pln">    factory</span><span class="pun">(</span><span class="str">'alert'</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">function</span><span class="pun">(</span><span class="pln">$window</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span></li><li class="L3"><span class="pln">      </span><span class="kwd">return</span><span class="pln"> </span><span class="kwd">function</span><span class="pun">(</span><span class="pln">text</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span></li><li class="L4"><span class="pln">        $window</span><span class="pun">.</span><span class="pln">alert</span><span class="pun">(</span><span class="pln">text</span><span class="pun">);</span></li><li class="L5"><span class="pln">      </span><span class="pun">}</span></li><li class="L6"><span class="pln">    </span><span class="pun">}).</span></li><li class="L7"><span class="pln">&nbsp;</span></li><li class="L8"><span class="pln">    value</span><span class="pun">(</span><span class="str">'salutation'</span><span class="pun">,</span><span class="pln"> </span><span class="str">'Hello'</span><span class="pun">).</span></li><li class="L9"><span class="pln">&nbsp;</span></li><li class="L0"><span class="pln">    factory</span><span class="pun">(</span><span class="str">'greet'</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">function</span><span class="pun">(</span><span class="pln">alert</span><span class="pun">,</span><span class="pln"> salutation</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span></li><li class="L1"><span class="pln">      </span><span class="kwd">return</span><span class="pln"> </span><span class="kwd">function</span><span class="pun">(</span><span class="pln">name</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span></li><li class="L2"><span class="pln">        alert</span><span class="pun">(</span><span class="pln">salutation </span><span class="pun">+</span><span class="pln"> </span><span class="str">' '</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> name </span><span class="pun">+</span><span class="pln"> </span><span class="str">'!'</span><span class="pun">);</span></li><li class="L3"><span class="pln">      </span><span class="pun">}</span></li><li class="L4"><span class="pln">    </span><span class="pun">});</span></li></ol></pre>
<p>让我们写一些测试代码：</p>
<pre class="prettyprint linenums"><ol class="linenums"><li class="L0"><span class="pln">describe</span><span class="pun">(</span><span class="str">'myApp'</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">function</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span></li><li class="L1"><span class="pln">  </span><span class="com">// 加载相关的应用模块，然后加载指定的测试模块，它将把$window改写为一个mock版</span></li><li class="L2"><span class="pln">  </span><span class="com">// 所以，调用window.alert()将不会弹出一个提示框而阻塞测试的运行。这就是一个在测试容器中改写配置信息的例子。</span></li><li class="L3"><span class="pln">  beforeEach</span><span class="pun">(</span><span class="kwd">module</span><span class="pun">(</span><span class="str">'greetMod'</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">function</span><span class="pun">(</span><span class="pln">$provide</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span></li><li class="L4"><span class="pln">    $provide</span><span class="pun">.</span><span class="pln">value</span><span class="pun">(</span><span class="str">'$window'</span><span class="pun">,</span><span class="pln"> </span><span class="pun">{</span></li><li class="L5"><span class="pln">      alert</span><span class="pun">:</span><span class="pln"> jasmine</span><span class="pun">.</span><span class="pln">createSpy</span><span class="pun">(</span><span class="str">'alert'</span><span class="pun">)</span></li><li class="L6"><span class="pln">    </span><span class="pun">});</span></li><li class="L7"><span class="pln">  </span><span class="pun">}));</span></li><li class="L8"><span class="pln">&nbsp;</span></li><li class="L9"><span class="pln">  </span><span class="com">// inject()函数将创建一个注入器，并且把greet服务和$window服务注入到测试容器中。</span></li><li class="L0"><span class="pln">  </span><span class="com">// 测试代码不需要关心如何获取应用，只管测试它就行了。</span></li><li class="L1"><span class="pln">  it</span><span class="pun">(</span><span class="str">'should alert on $window'</span><span class="pun">,</span><span class="pln"> inject</span><span class="pun">(</span><span class="kwd">function</span><span class="pun">(</span><span class="pln">greet</span><span class="pun">,</span><span class="pln"> $window</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span></li><li class="L2"><span class="pln">    greet</span><span class="pun">(</span><span class="str">'World'</span><span class="pun">);</span></li><li class="L3"><span class="pln">    expect</span><span class="pun">(</span><span class="pln">$window</span><span class="pun">.</span><span class="pln">alert</span><span class="pun">).</span><span class="pln">toHaveBeenCalledWith</span><span class="pun">(</span><span class="str">'Hello World!'</span><span class="pun">);</span></li><li class="L4"><span class="pln">  </span><span class="pun">}));</span></li><li class="L5"><span class="pln">&nbsp;</span></li><li class="L6"><span class="pln">  </span><span class="com">// 这是让测试容器改写配置的另一种方案：使用内嵌模块和依赖注入</span></li><li class="L7"><span class="pln">  it</span><span class="pun">(</span><span class="str">'should alert using the alert service'</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">function</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span></li><li class="L8"><span class="pln">    </span><span class="kwd">var</span><span class="pln"> alertSpy </span><span class="pun">=</span><span class="pln"> jasmine</span><span class="pun">.</span><span class="pln">createSpy</span><span class="pun">(</span><span class="str">'alert'</span><span class="pun">);</span></li><li class="L9"><span class="pln">    </span><span class="kwd">module</span><span class="pun">(</span><span class="kwd">function</span><span class="pun">(</span><span class="pln">$provide</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span></li><li class="L0"><span class="pln">      $provide</span><span class="pun">.</span><span class="pln">value</span><span class="pun">(</span><span class="str">'alert'</span><span class="pun">,</span><span class="pln"> alertSpy</span><span class="pun">);</span></li><li class="L1"><span class="pln">    </span><span class="pun">});</span></li><li class="L2"><span class="pln">    inject</span><span class="pun">(</span><span class="kwd">function</span><span class="pun">(</span><span class="pln">greet</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span></li><li class="L3"><span class="pln">      greet</span><span class="pun">(</span><span class="str">'World'</span><span class="pun">);</span></li><li class="L4"><span class="pln">      expect</span><span class="pun">(</span><span class="pln">alertSpy</span><span class="pun">).</span><span class="pln">toHaveBeenCalledWith</span><span class="pun">(</span><span class="str">'Hello World!'</span><span class="pun">);</span></li><li class="L5"><span class="pln">    </span><span class="pun">});</span></li><li class="L6"><span class="pln">  </span><span class="pun">});</span></li><li class="L7"><span class="pun">});</span></li></ol></pre>
		
	<div class="ad1">	
<script async="" src="http://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<!-- 336 x 280 -->
<ins class="adsbygoogle" style="display:inline-block;width:336px;height:280px" data-ad-client="ca-pub-6117966252207595" data-ad-slot="9942648348"></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
</div>	
	
		</div>
	</div>
</div>
<footer>
	<p>Copyright © 2014 - 2018 <a href="http://www.angularjs.net.cn/">AngularJS中文网</a>, <a href="http://www.miitbeian.gov.cn/" target="_blank">粤ICP备15074038号-4</a>, All Rights Reserved.

</p>
</footer>
<script type="text/javascript">
    /*图+推广*/
    /*建议投放在200*300以上的图片*/
    var cpro_id = "u1948815";
</script>
<script type="text/javascript" src="./16.AngularJS 模块(Modules)_files/i.js.下载"></script>


<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?12ec03a62d55d8fb4b144b14ccedecec";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>


<script src="./16.AngularJS 模块(Modules)_files/jquery.js.下载"></script>
<script src="./16.AngularJS 模块(Modules)_files/common.js.下载"></script>
<script src="./16.AngularJS 模块(Modules)_files/bootstrap.min.js.下载"></script>

</body></html>