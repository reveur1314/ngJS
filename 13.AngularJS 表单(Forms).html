<!DOCTYPE html>
<!-- saved from url=(0043)http://www.angularjs.net.cn/tutorial/4.html -->
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>AngularJS 表单(Forms)</title>
<link rel="icon" href="http://www.angularjs.net.cn/Application/Home/View/Public/img/favicon.ico" type="image/x-icon">
<link rel="stylesheet" href="./13.AngularJS 表单(Forms)_files/bootstrap.min.css">
<link href="./13.AngularJS 表单(Forms)_files/prettify.css" rel="stylesheet">
<script src="./13.AngularJS 表单(Forms)_files/hm.js.下载"></script><script src="./13.AngularJS 表单(Forms)_files/prettify.js.下载"></script>


<link rel="stylesheet" href="./13.AngularJS 表单(Forms)_files/style.css">

</head>
<body onload="prettyPrint()">
<div id="top">
	<div class="container">
	<div class="logo"><a href="http://www.angularjs.net.cn/">AngularJs中文网</a></div>
	<ul>
		<li><a href="http://www.angularjs.net.cn/">首页</a></li>
		<li><a href="http://www.angularjs.net.cn/tutorial/">AngularJS 教程</a></li>
		
		<li><a href="http://www.angularjs.net.cn/phonecat/">AngularJS PhoneCat</a></li>
		<li><a href="http://www.angularjs.net.cn/download/">AngularJS 下载</a></li>
		<li><a href="http://www.angularjs.net.cn/api/">AngularJS api</a></li>
		<li style="display:none;"><a href="http://www.angularjs.net.cn/angular-seed">AngularJS Seed</a></li>
	<li><a href="https://promotion.aliyun.com/ntms/act/qwbk.html?userCode=iuvvbh9n" onclick="_hmt.push([&#39;_trackEvent&#39;, &#39;nav&#39;, &#39;click&#39;, &#39;Ecs&#39;])" target="_blank">Ecs服务器</a></li>
	

	
	</ul>
	</div>
</div>


<div class="container">
	<div class="row">
		<div class="col-md-3">
<ul>
	<li><a href="http://www.angularjs.net.cn/tutorial/1.html">简介（Introduction）</a></li><li><a href="http://www.angularjs.net.cn/tutorial/16.html">引导程序（Bootstrap）</a></li><li><a href="http://www.angularjs.net.cn/tutorial/18.html">概念概述(Conceptual Overview)</a></li><li><a href="http://www.angularjs.net.cn/tutorial/15.html">Html编译（HTML Compiler）</a></li><li><a href="http://www.angularjs.net.cn/tutorial/10.html">数据绑定（Data Binding）</a></li><li><a href="http://www.angularjs.net.cn/tutorial/2.html">控制器(Controllers)</a></li><li><a href="http://www.angularjs.net.cn/tutorial/19.html">服务（Services）</a></li><li><a href="http://www.angularjs.net.cn/tutorial/12.html">作用域(Scope)</a></li><li><a href="http://www.angularjs.net.cn/tutorial/17.html">依赖注入(Dependency Injection)</a></li><li><a href="http://www.angularjs.net.cn/tutorial/13.html">模板（Templates）</a></li><li><a href="http://www.angularjs.net.cn/tutorial/11.html">使用css(Working With CSS)</a></li><li><a href="http://www.angularjs.net.cn/tutorial/8.html">过滤器（Filters）</a></li><li><a href="http://www.angularjs.net.cn/tutorial/4.html">表单(Forms)</a></li><li><a href="http://www.angularjs.net.cn/tutorial/5.html">指令(Directives)</a></li><li><a href="http://www.angularjs.net.cn/tutorial/20.html">Components</a></li><li><a href="http://www.angularjs.net.cn/tutorial/21.html">Component Router</a></li><li><a href="http://www.angularjs.net.cn/tutorial/7.html">动画(Animations)</a></li><li><a href="http://www.angularjs.net.cn/tutorial/6.html">模块(Modules)</a></li><li><a href="http://www.angularjs.net.cn/tutorial/3.html">表达式(Expressions)</a></li><li><a href="http://www.angularjs.net.cn/tutorial/9.html">供应者（Providers）</a></li><li><a href="http://www.angularjs.net.cn/tutorial/14.html">$location</a></li><li><a href="http://www.angularjs.net.cn/tutorial/22.html">单元测试</a></li><li><a href="http://www.angularjs.net.cn/tutorial/23.html">端对端测试</a></li></ul>
<div id="ad">
<script async="" src="http://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<!-- 160x600 -->
<ins class="adsbygoogle" style="display:inline-block;width:160px;height:600px" data-ad-client="ca-pub-6117966252207595" data-ad-slot="1088261149"></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
</div>
</div>
		<div class="col-md-9">
			<div class="page-header"><h1>AngularJS 表单(Forms)</h1></div>

<div style="margin-bottom:10px;">
<script async="" src="http://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<!-- 728x90 --><ins class="adsbygoogle" style="display:inline-block;width:728px;height:90px" data-ad-client="ca-pub-6117966252207595" data-ad-slot="2639707541"></ins>
<script>(adsbygoogle = window.adsbygoogle || []).push({});</script>
<script async="" src="http://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<!-- 728x90 --><ins class="adsbygoogle" style="display:inline-block;width:728px;height:90px" data-ad-client="ca-pub-6117966252207595" data-ad-slot="2639707541"></ins>
<script>(adsbygoogle = window.adsbygoogle || []).push({});</script>
</div>
			
			
<p>控件 (<code><span class="pln">input</span></code>, <code><span class="kwd">select</span></code>, <code><span class="pln">textarea</span></code>) 是用户输入数据的一种方式。一个表单就是多个控件的集合，用来组织相关的控件。</p>
<p>表单和控件提供验证服务，在用户输入信息有误的时候进行提示。
这提升了用户体验，因为我们在第一时间告知用户什么地方出错了、如何修正错误。
记住，尽管客户端（浏览器）验证在用户体验方面起了重要作用，但是，它很容易被绕过，因此是不能信任的。
为了应用的安全，服务端的验证仍然是必须的。</p>
<hr>
<h2>简单的表单</h2>
<p>理解双向绑定的关键指令是<a href="http://www.angularjs.net.cn/tutorial/api/ng.directive:ngModel"><code><span class="pln">ngModel</span></code></a>.
指令<code><span class="pln">ngModel</span></code>通过维护“数据到视图”的同步以及“视图到数据”的同步实现了双向绑定。
另外，它还提供了<a href="http://www.angularjs.net.cn/tutorial/api/ng.directive:ngModel.NgModelController"><code><span class="pln">API</span></code></a>来让其他指令扩展其行为。</p>
<h3>源码</h3>

<div class="tabbable" role="tablist">
<ul class="nav nav-tabs">
<li class="active"><a href="http://www.angularjs.net.cn/tutorial/4.html#html1" role="tab" data-toggle="tab">index.html</a></li>
<li><a href="http://www.angularjs.net.cn/tutorial/4.html#js1" role="tab" data-toggle="tab">script.js</a></li></ul>

<div class="tab-content">
<div class="tab-pane active" title="index.html" id="html1">
<pre class="prettyprint linenums ng-binding" ng-set-text="index.html-238" ng-html-wrap=" angular.js script.js"><ol class="linenums"><li class="L0"><span class="dec">&lt;!doctype html&gt;</span></li><li class="L1"><span class="tag">&lt;html</span><span class="pln"> </span><span class="atn">ng-app</span><span class="tag">&gt;</span></li><li class="L2"><span class="pln">  </span><span class="tag">&lt;head&gt;</span></li><li class="L3"><span class="pln">    </span><span class="tag">&lt;script</span><span class="pln"> </span><span class="atn">src</span><span class="pun">=</span><span class="atv">"http://code.angularjs.org/1.2.25/angular.min.js"</span><span class="tag">&gt;&lt;/script&gt;</span></li><li class="L4"><span class="pln">    </span><span class="tag">&lt;script</span><span class="pln"> </span><span class="atn">src</span><span class="pun">=</span><span class="atv">"script.js"</span><span class="tag">&gt;&lt;/script&gt;</span></li><li class="L5"><span class="pln">  </span><span class="tag">&lt;/head&gt;</span></li><li class="L6"><span class="pln">  </span><span class="tag">&lt;body&gt;</span></li><li class="L7"><span class="pln">    </span><span class="tag">&lt;div</span><span class="pln"> </span><span class="atn">ng-controller</span><span class="pun">=</span><span class="atv">"Controller"</span><span class="tag">&gt;</span></li><li class="L8"><span class="pln">      </span><span class="tag">&lt;form</span><span class="pln"> </span><span class="atn">novalidate</span><span class="pln"> </span><span class="atn">class</span><span class="pun">=</span><span class="atv">"simple-form"</span><span class="tag">&gt;</span></li><li class="L9"><span class="pln">        Name: </span><span class="tag">&lt;input</span><span class="pln"> </span><span class="atn">type</span><span class="pun">=</span><span class="atv">"text"</span><span class="pln"> </span><span class="atn">ng-model</span><span class="pun">=</span><span class="atv">"user.name"</span><span class="pln"> </span><span class="tag">/&gt;&lt;br</span><span class="pln"> </span><span class="tag">/&gt;</span></li><li class="L0"><span class="pln">        E-mail: </span><span class="tag">&lt;input</span><span class="pln"> </span><span class="atn">type</span><span class="pun">=</span><span class="atv">"email"</span><span class="pln"> </span><span class="atn">ng-model</span><span class="pun">=</span><span class="atv">"user.email"</span><span class="pln"> </span><span class="tag">/&gt;&lt;br</span><span class="pln"> </span><span class="tag">/&gt;</span></li><li class="L1"><span class="pln">        Gender: </span><span class="tag">&lt;input</span><span class="pln"> </span><span class="atn">type</span><span class="pun">=</span><span class="atv">"radio"</span><span class="pln"> </span><span class="atn">ng-model</span><span class="pun">=</span><span class="atv">"user.gender"</span><span class="pln"> </span><span class="atn">value</span><span class="pun">=</span><span class="atv">"male"</span><span class="pln"> </span><span class="tag">/&gt;</span><span class="pln">male</span></li><li class="L2"><span class="pln">        </span><span class="tag">&lt;input</span><span class="pln"> </span><span class="atn">type</span><span class="pun">=</span><span class="atv">"radio"</span><span class="pln"> </span><span class="atn">ng-model</span><span class="pun">=</span><span class="atv">"user.gender"</span><span class="pln"> </span><span class="atn">value</span><span class="pun">=</span><span class="atv">"female"</span><span class="pln"> </span><span class="tag">/&gt;</span><span class="pln">female</span><span class="tag">&lt;br</span><span class="pln"> </span><span class="tag">/&gt;</span></li><li class="L3"><span class="pln">        </span><span class="tag">&lt;button</span><span class="pln"> </span><span class="atn">ng-click</span><span class="pun">=</span><span class="atv">"reset()"</span><span class="tag">&gt;</span><span class="pln">RESET</span><span class="tag">&lt;/button&gt;</span></li><li class="L4"><span class="pln">        </span><span class="tag">&lt;button</span><span class="pln"> </span><span class="atn">ng-click</span><span class="pun">=</span><span class="atv">"update(user)"</span><span class="tag">&gt;</span><span class="pln">SAVE</span><span class="tag">&lt;/button&gt;</span></li><li class="L5"><span class="pln">      </span><span class="tag">&lt;/form&gt;</span></li><li class="L6"><span class="pln">      </span><span class="tag">&lt;pre&gt;</span><span class="pln">form =  {{user | json}} </span><span class="tag">&lt;/pre&gt;</span></li><li class="L7"><span class="pln">      </span><span class="tag">&lt;pre&gt;</span><span class="pln">master =  {{master | json}} </span><span class="tag">&lt;/pre&gt;</span></li><li class="L8"><span class="pln">    </span><span class="tag">&lt;/div&gt;</span></li><li class="L9"><span class="pln">  </span><span class="tag">&lt;/body&gt;</span></li><li class="L0"><span class="tag">&lt;/html&gt;</span></li></ol></pre>
</div>
<div class="tab-pane" title="script.js" id="js1">
<pre class="prettyprint linenums" ng-set-text="script.js-237"><ol class="linenums"><li class="L0"><span class="kwd">function</span><span class="pln"> </span><span class="typ">Controller</span><span class="pun">(</span><span class="pln">$scope</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span></li><li class="L1"><span class="pln">  $scope</span><span class="pun">.</span><span class="pln">master </span><span class="pun">=</span><span class="pln"> </span><span class="pun">{};</span></li><li class="L2"><span class="pln">&nbsp;</span></li><li class="L3"><span class="pln">  $scope</span><span class="pun">.</span><span class="pln">update </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">function</span><span class="pun">(</span><span class="pln">user</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span></li><li class="L4"><span class="pln">    $scope</span><span class="pun">.</span><span class="pln">master </span><span class="pun">=</span><span class="pln"> angular</span><span class="pun">.</span><span class="pln">copy</span><span class="pun">(</span><span class="pln">user</span><span class="pun">);</span></li><li class="L5"><span class="pln">  </span><span class="pun">};</span></li><li class="L6"><span class="pln">&nbsp;</span></li><li class="L7"><span class="pln">  $scope</span><span class="pun">.</span><span class="pln">reset </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">function</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span></li><li class="L8"><span class="pln">    $scope</span><span class="pun">.</span><span class="pln">user </span><span class="pun">=</span><span class="pln"> angular</span><span class="pun">.</span><span class="pln">copy</span><span class="pun">(</span><span class="pln">$scope</span><span class="pun">.</span><span class="pln">master</span><span class="pun">);</span></li><li class="L9"><span class="pln">  </span><span class="pun">};</span></li><li class="L0"><span class="pln">&nbsp;</span></li><li class="L1"><span class="pln">  $scope</span><span class="pun">.</span><span class="pln">reset</span><span class="pun">();</span></li><li class="L2"><span class="pun">}</span></li></ol></pre>

</div>
</div></div>


<h3>效果</h3>
<div class="well">
	<iframe src="./13.AngularJS 表单(Forms)_files/7.html"></iframe>
</div>
<p>其中 <code><span class="pln">novalidate</span></code> 属性用于禁用浏览器自带的表单验证功能。</p>
<hr>
<h2 id="使用-css-类">使用 CSS 类</h2>
<p>为了允许对表单和控件自定义样式， <code><span class="pln">ngModel</span></code> 增加了如下的CSS类：
- <code><span class="pln">ng</span><span class="pun">-</span><span class="pln">valid</span></code>
- <code><span class="pln">ng</span><span class="pun">-</span><span class="pln">invalid</span></code>
- <code><span class="pln">ng</span><span class="pun">-</span><span class="pln">pristine</span></code>
- <code><span class="pln">ng</span><span class="pun">-</span><span class="pln">dirty</span></code></p>
<p>接下来的例子中使用这些CSS类来表明每一个表单控件是否有效。
在例子中，<code><span class="pln">user</span><span class="pun">.</span><span class="pln">name</span></code> 和 <code><span class="pln">user</span><span class="pun">.</span><span class="pln">email</span></code> 都是必需的（required），它们仅在成为脏数据(dirty)时才会显示红色背景，但不会在初始状态下（也为空）显示。
这样就防止了用户在尚未与该控件进行交互，而该控件的当前状态恰好不符合验证条件的时候，出现不恰当的错误提示。</p>
<h3>源码</h3>

<div class="tabbable">
<ul class="nav nav-tabs" role="tablist">
<li class="active"><a href="http://www.angularjs.net.cn/tutorial/4.html#html2" role="tab" data-toggle="tab">index.html</a></li>
<li><a href="http://www.angularjs.net.cn/tutorial/4.html#js2" role="tab" data-toggle="tab">script.js</a></li>
</ul><div class="tab-content">

<div class="tab-pane active" title="index.html" id="html2">
<pre class="prettyprint linenums" ng-set-text="index.html-240" ng-html-wrap=" angular.js script.js"><ol class="linenums"><li class="L0"><span class="dec">&lt;!doctype html&gt;</span></li><li class="L1"><span class="tag">&lt;html</span><span class="pln"> </span><span class="atn">ng-app</span><span class="tag">&gt;</span></li><li class="L2"><span class="pln">  </span><span class="tag">&lt;head&gt;</span></li><li class="L3"><span class="pln">    </span><span class="tag">&lt;script</span><span class="pln"> </span><span class="atn">src</span><span class="pun">=</span><span class="atv">"http://code.angularjs.org/1.2.25/angular.min.js"</span><span class="tag">&gt;&lt;/script&gt;</span></li><li class="L4"><span class="pln">    </span><span class="tag">&lt;script</span><span class="pln"> </span><span class="atn">src</span><span class="pun">=</span><span class="atv">"script.js"</span><span class="tag">&gt;&lt;/script&gt;</span></li><li class="L5"><span class="pln">  </span><span class="tag">&lt;/head&gt;</span></li><li class="L6"><span class="pln">  </span><span class="tag">&lt;body&gt;</span></li><li class="L7"><span class="pln">    </span><span class="tag">&lt;div</span><span class="pln"> </span><span class="atn">ng-controller</span><span class="pun">=</span><span class="atv">"Controller"</span><span class="tag">&gt;</span></li><li class="L8"><span class="pln">      </span><span class="tag">&lt;form</span><span class="pln"> </span><span class="atn">novalidate</span><span class="pln"> </span><span class="atn">class</span><span class="pun">=</span><span class="atv">"css-form"</span><span class="tag">&gt;</span></li><li class="L9"><span class="pln">        Name:</span></li><li class="L0"><span class="pln">          </span><span class="tag">&lt;input</span><span class="pln"> </span><span class="atn">type</span><span class="pun">=</span><span class="atv">"text"</span><span class="pln"> </span><span class="atn">ng-model</span><span class="pun">=</span><span class="atv">"user.name"</span><span class="pln"> </span><span class="atn">required</span><span class="pln"> </span><span class="tag">/&gt;&lt;br</span><span class="pln"> </span><span class="tag">/&gt;</span></li><li class="L1"><span class="pln">        邮箱: </span><span class="tag">&lt;input</span><span class="pln"> </span><span class="atn">type</span><span class="pun">=</span><span class="atv">"email"</span><span class="pln"> </span><span class="atn">ng-model</span><span class="pun">=</span><span class="atv">"user.email"</span><span class="pln"> </span><span class="atn">required</span><span class="pln"> </span><span class="tag">/&gt;&lt;br</span><span class="pln"> </span><span class="tag">/&gt;</span></li><li class="L2"><span class="pln">        性别: </span><span class="tag">&lt;label&gt;&lt;input</span><span class="pln"> </span><span class="atn">type</span><span class="pun">=</span><span class="atv">"radio"</span><span class="pln"> </span><span class="atn">ng-model</span><span class="pun">=</span><span class="atv">"user.gender"</span><span class="pln"> </span><span class="atn">value</span><span class="pun">=</span><span class="atv">"male"</span><span class="pln"> </span><span class="tag">/&gt;</span><span class="pln">男</span><span class="tag">&lt;/label&gt;</span></li><li class="L3"><span class="pln">        </span><span class="tag">&lt;label&gt;&lt;input</span><span class="pln"> </span><span class="atn">type</span><span class="pun">=</span><span class="atv">"radio"</span><span class="pln"> </span><span class="atn">ng-model</span><span class="pun">=</span><span class="atv">"user.gender"</span><span class="pln"> </span><span class="atn">value</span><span class="pun">=</span><span class="atv">"female"</span><span class="pln"> </span><span class="tag">/&gt;</span><span class="pln">女</span><span class="tag">&lt;/label&gt;&lt;br</span><span class="pln"> </span><span class="tag">/&gt;</span></li><li class="L4"><span class="pln">        </span><span class="tag">&lt;button</span><span class="pln"> </span><span class="atn">ng-click</span><span class="pun">=</span><span class="atv">"reset()"</span><span class="tag">&gt;</span><span class="pln">重置</span><span class="tag">&lt;/button&gt;</span></li><li class="L5"><span class="pln">        </span><span class="tag">&lt;button</span><span class="pln"> </span><span class="atn">ng-click</span><span class="pun">=</span><span class="atv">"update(user)"</span><span class="tag">&gt;</span><span class="pln">保存</span><span class="tag">&lt;/button&gt;</span></li><li class="L6"><span class="pln">      </span><span class="tag">&lt;/form&gt;</span></li><li class="L7"><span class="pln">    </span><span class="tag">&lt;/div&gt;</span></li><li class="L8"><span class="pln">    </span></li><li class="L9"><span class="pln">    </span><span class="tag">&lt;style</span><span class="pln"> </span><span class="atn">type</span><span class="pun">=</span><span class="atv">"text/css"</span><span class="tag">&gt;</span></li><li class="L0"><span class="pln">      </span><span class="pun">.</span><span class="pln">css</span><span class="pun">-</span><span class="pln">form input</span><span class="pun">.</span><span class="pln">ng</span><span class="pun">-</span><span class="pln">invalid</span><span class="pun">.</span><span class="pln">ng</span><span class="pun">-</span><span class="pln">dirty </span><span class="pun">{</span></li><li class="L1"><span class="pln">        background</span><span class="pun">-</span><span class="pln">color</span><span class="pun">:</span><span class="pln"> </span><span class="com">#FA787E;</span></li><li class="L2"><span class="pln">      </span><span class="pun">}</span></li><li class="L3"><span class="pln">    </span></li><li class="L4"><span class="pln">      </span><span class="pun">.</span><span class="pln">css</span><span class="pun">-</span><span class="pln">form input</span><span class="pun">.</span><span class="pln">ng</span><span class="pun">-</span><span class="pln">valid</span><span class="pun">.</span><span class="pln">ng</span><span class="pun">-</span><span class="pln">dirty </span><span class="pun">{</span></li><li class="L5"><span class="pln">        background</span><span class="pun">-</span><span class="pln">color</span><span class="pun">:</span><span class="pln"> </span><span class="com">#78FA89;</span></li><li class="L6"><span class="pln">      </span><span class="pun">}</span></li><li class="L7"><span class="pln">    </span><span class="tag">&lt;/style&gt;</span></li><li class="L8"><span class="pln">  </span><span class="tag">&lt;/body&gt;</span></li><li class="L9"><span class="tag">&lt;/html&gt;</span></li></ol></pre>

</div>
<div class="tab-pane" title="script.js" id="js2">
<pre class="prettyprint linenums" ng-set-text="script.js-239"><ol class="linenums"><li class="L0"><span class="kwd">function</span><span class="pln"> </span><span class="typ">Controller</span><span class="pun">(</span><span class="pln">$scope</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span></li><li class="L1"><span class="pln">  $scope</span><span class="pun">.</span><span class="pln">master </span><span class="pun">=</span><span class="pln"> </span><span class="pun">{};</span></li><li class="L2"><span class="pln">&nbsp;</span></li><li class="L3"><span class="pln">  $scope</span><span class="pun">.</span><span class="pln">update </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">function</span><span class="pun">(</span><span class="pln">user</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span></li><li class="L4"><span class="pln">    $scope</span><span class="pun">.</span><span class="pln">master </span><span class="pun">=</span><span class="pln"> angular</span><span class="pun">.</span><span class="pln">copy</span><span class="pun">(</span><span class="pln">user</span><span class="pun">);</span></li><li class="L5"><span class="pln">  </span><span class="pun">};</span></li><li class="L6"><span class="pln">&nbsp;</span></li><li class="L7"><span class="pln">  $scope</span><span class="pun">.</span><span class="pln">reset </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">function</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span></li><li class="L8"><span class="pln">    $scope</span><span class="pun">.</span><span class="pln">user </span><span class="pun">=</span><span class="pln"> angular</span><span class="pun">.</span><span class="pln">copy</span><span class="pun">(</span><span class="pln">$scope</span><span class="pun">.</span><span class="pln">master</span><span class="pun">);</span></li><li class="L9"><span class="pln">  </span><span class="pun">};</span></li><li class="L0"><span class="pln">&nbsp;</span></li><li class="L1"><span class="pln">  $scope</span><span class="pun">.</span><span class="pln">reset</span><span class="pun">();</span></li><li class="L2"><span class="pun">}</span></li></ol></pre>

</div>
</div></div>

<h3>效果</h3>
<div class="well ">
	<iframe src="./13.AngularJS 表单(Forms)_files/8.html"></iframe>
</div>
<hr>
<h2>与表单绑定和控制状态</h2>
<p>一个表单是一个 <a href="http://www.angularjs.net.cn/tutorial/api/ng.directive:form.FormController"><code><span class="typ">FormController</span></code></a> 的实例。
这个表单实例可以通过 'name' 属性装载到scope中去。</p>
<p>类似的，一个拥有 <a href="http://www.angularjs.net.cn/tutorial/api/ng.directive:ngModel"><code><span class="pln">api</span><span class="pun">/</span><span class="pln">ng</span><span class="pun">.</span><span class="pln">directive</span><span class="pun">:</span><span class="pln">ngModel</span></code></a> 指令的输入控件，包含一个<a href="http://www.angularjs.net.cn/tutorial/api/ng.directive:ngModel.NgModelController"><code><span class="typ">NgModelController</span></code></a>实例。
这样一个控件的实例可以使用 'name' 属性装载到表单实例中去，作为表单实例的一个字段。name属性指定了其在表单实例中的字段名。</p>
<p>这意味着，在视图中使用基本的数据绑定形式就可以访问到表单和控件中的内部状态。</p>
<p>这让我们可以为上面的例子扩展以下功能：</p>
<ul>
<li>重置按钮 只在表单有改变的时候才可用</li>
<li>保存按钮 只在表单有改变且数据有效的时候才可用</li>
<li>为 <code><span class="pln">user</span><span class="pun">.</span><span class="pln">email</span></code> 和 <code><span class="pln">user</span><span class="pun">.</span><span class="pln">agree</span></code> 自定义错误提示信息</li>
</ul>
<h3>源码</h3>

<div class="tabbable">
<ul class="nav nav-tabs" role="tablist">
<li class="active"><a href="http://www.angularjs.net.cn/tutorial/4.html#html3" role="tab" data-toggle="tab">index.html</a></li>
<li><a href="http://www.angularjs.net.cn/tutorial/4.html#js3" role="tab" data-toggle="tab">script.js</a></li>
</ul>
<div class="tab-content">
<div class="tab-pane active" title="index.html" id="html3">
<pre class="prettyprint linenums" ng-set-text="index.html-242" ng-html-wrap=" angular.js script.js"><ol class="linenums"><li class="L0"><span class="dec">&lt;!doctype html&gt;</span></li><li class="L1"><span class="tag">&lt;html</span><span class="pln"> </span><span class="atn">ng-app</span><span class="tag">&gt;</span></li><li class="L2"><span class="pln">  </span><span class="tag">&lt;head&gt;</span></li><li class="L3"><span class="pln">    </span><span class="tag">&lt;script</span><span class="pln"> </span><span class="atn">src</span><span class="pun">=</span><span class="atv">"http://code.angularjs.org/1.2.25/angular.min.js"</span><span class="tag">&gt;&lt;/script&gt;</span></li><li class="L4"><span class="pln">    </span><span class="tag">&lt;script</span><span class="pln"> </span><span class="atn">src</span><span class="pun">=</span><span class="atv">"script.js"</span><span class="tag">&gt;&lt;/script&gt;</span></li><li class="L5"><span class="pln">  </span><span class="tag">&lt;/head&gt;</span></li><li class="L6"><span class="pln">  </span><span class="tag">&lt;body&gt;</span></li><li class="L7"><span class="pln">    </span><span class="tag">&lt;div</span><span class="pln"> </span><span class="atn">ng-controller</span><span class="pun">=</span><span class="atv">"Controller"</span><span class="tag">&gt;</span></li><li class="L8"><span class="pln">      </span><span class="tag">&lt;form</span><span class="pln"> </span><span class="atn">name</span><span class="pun">=</span><span class="atv">"form"</span><span class="pln"> </span><span class="atn">class</span><span class="pun">=</span><span class="atv">"css-form"</span><span class="pln"> </span><span class="atn">novalidate</span><span class="tag">&gt;</span></li><li class="L9"><span class="pln">        Name:</span></li><li class="L0"><span class="pln">          </span><span class="tag">&lt;input</span><span class="pln"> </span><span class="atn">type</span><span class="pun">=</span><span class="atv">"text"</span><span class="pln"> </span><span class="atn">ng-model</span><span class="pun">=</span><span class="atv">"user.name"</span><span class="pln"> </span><span class="atn">name</span><span class="pun">=</span><span class="atv">"uName"</span><span class="pln"> </span><span class="atn">required</span><span class="pln"> </span><span class="tag">/&gt;&lt;br</span><span class="pln"> </span><span class="tag">/&gt;</span></li><li class="L1"><span class="pln">        E-mail:</span></li><li class="L2"><span class="pln">          </span><span class="tag">&lt;input</span><span class="pln"> </span><span class="atn">type</span><span class="pun">=</span><span class="atv">"email"</span><span class="pln"> </span><span class="atn">ng-model</span><span class="pun">=</span><span class="atv">"user.email"</span><span class="pln"> </span><span class="atn">name</span><span class="pun">=</span><span class="atv">"uEmail"</span><span class="pln"> </span><span class="atn">required</span><span class="tag">/&gt;&lt;br</span><span class="pln"> </span><span class="tag">/&gt;</span></li><li class="L3"><span class="pln">        </span><span class="tag">&lt;div</span><span class="pln"> </span><span class="atn">ng-show</span><span class="pun">=</span><span class="atv">"form.uEmail.$dirty &amp;&amp; form.uEmail.$invalid"</span><span class="tag">&gt;</span><span class="pln">Invalid:</span></li><li class="L4"><span class="pln">          </span><span class="tag">&lt;span</span><span class="pln"> </span><span class="atn">ng-show</span><span class="pun">=</span><span class="atv">"form.uEmail.$error.required"</span><span class="tag">&gt;</span><span class="pln">Tell us your email.</span><span class="tag">&lt;/span&gt;</span></li><li class="L5"><span class="pln">          </span><span class="tag">&lt;span</span><span class="pln"> </span><span class="atn">ng-show</span><span class="pun">=</span><span class="atv">"form.uEmail.$error.email"</span><span class="tag">&gt;</span><span class="pln">This is not a valid email.</span><span class="tag">&lt;/span&gt;</span></li><li class="L6"><span class="pln">        </span><span class="tag">&lt;/div&gt;</span></li><li class="L7"><span class="pln">    </span></li><li class="L8"><span class="pln">        Gender: </span><span class="tag">&lt;input</span><span class="pln"> </span><span class="atn">type</span><span class="pun">=</span><span class="atv">"radio"</span><span class="pln"> </span><span class="atn">ng-model</span><span class="pun">=</span><span class="atv">"user.gender"</span><span class="pln"> </span><span class="atn">value</span><span class="pun">=</span><span class="atv">"male"</span><span class="pln"> </span><span class="tag">/&gt;</span><span class="pln">male</span></li><li class="L9"><span class="pln">        </span><span class="tag">&lt;input</span><span class="pln"> </span><span class="atn">type</span><span class="pun">=</span><span class="atv">"radio"</span><span class="pln"> </span><span class="atn">ng-model</span><span class="pun">=</span><span class="atv">"user.gender"</span><span class="pln"> </span><span class="atn">value</span><span class="pun">=</span><span class="atv">"female"</span><span class="pln"> </span><span class="tag">/&gt;</span><span class="pln">female</span><span class="tag">&lt;br</span><span class="pln"> </span><span class="tag">/&gt;</span></li><li class="L0"><span class="pln">    </span></li><li class="L1"><span class="pln">        </span><span class="tag">&lt;input</span><span class="pln"> </span><span class="atn">type</span><span class="pun">=</span><span class="atv">"checkbox"</span><span class="pln"> </span><span class="atn">ng-model</span><span class="pun">=</span><span class="atv">"user.agree"</span><span class="pln"> </span><span class="atn">name</span><span class="pun">=</span><span class="atv">"userAgree"</span><span class="pln"> </span><span class="atn">required</span><span class="pln"> </span><span class="tag">/&gt;</span></li><li class="L2"><span class="pln">        I agree: </span><span class="tag">&lt;input</span><span class="pln"> </span><span class="atn">ng-show</span><span class="pun">=</span><span class="atv">"user.agree"</span><span class="pln"> </span><span class="atn">type</span><span class="pun">=</span><span class="atv">"text"</span><span class="pln"> </span><span class="atn">ng-model</span><span class="pun">=</span><span class="atv">"user.agreeSign"</span></li><li class="L3"><span class="pln">                  </span><span class="atn">required</span><span class="pln"> </span><span class="tag">/&gt;&lt;br</span><span class="pln"> </span><span class="tag">/&gt;</span></li><li class="L4"><span class="pln">        </span><span class="tag">&lt;div</span><span class="pln"> </span><span class="atn">ng-show</span><span class="pun">=</span><span class="atv">"!user.agree || !user.agreeSign"</span><span class="tag">&gt;</span><span class="pln">Please agree and sign.</span><span class="tag">&lt;/div&gt;</span></li><li class="L5"><span class="pln">    </span></li><li class="L6"><span class="pln">        </span><span class="tag">&lt;button</span><span class="pln"> </span><span class="atn">ng-click</span><span class="pun">=</span><span class="atv">"reset()"</span><span class="pln"> </span><span class="atn">ng-disabled</span><span class="pun">=</span><span class="atv">"isUnchanged(user)"</span><span class="tag">&gt;</span><span class="pln">RESET</span><span class="tag">&lt;/button&gt;</span></li><li class="L7"><span class="pln">        </span><span class="tag">&lt;button</span><span class="pln"> </span><span class="atn">ng-click</span><span class="pun">=</span><span class="atv">"update(user)"</span></li><li class="L8"><span class="pln">                </span><span class="atn">ng-disabled</span><span class="pun">=</span><span class="atv">"form.$invalid || isUnchanged(user)"</span><span class="tag">&gt;</span><span class="pln">SAVE</span><span class="tag">&lt;/button&gt;</span></li><li class="L9"><span class="pln">      </span><span class="tag">&lt;/form&gt;</span></li><li class="L0"><span class="pln">    </span><span class="tag">&lt;/div&gt;</span></li><li class="L1"><span class="pln">  </span><span class="tag">&lt;/body&gt;</span></li><li class="L2"><span class="tag">&lt;/html&gt;</span></li></ol></pre>
</div>
<div class="tab-pane" title="script.js" id="js3">
<pre class="prettyprint linenums" ng-set-text="script.js-241"><ol class="linenums"><li class="L0"><span class="kwd">function</span><span class="pln"> </span><span class="typ">Controller</span><span class="pun">(</span><span class="pln">$scope</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span></li><li class="L1"><span class="pln">  $scope</span><span class="pun">.</span><span class="pln">master </span><span class="pun">=</span><span class="pln"> </span><span class="pun">{};</span></li><li class="L2"><span class="pln">&nbsp;</span></li><li class="L3"><span class="pln">  $scope</span><span class="pun">.</span><span class="pln">update </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">function</span><span class="pun">(</span><span class="pln">user</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span></li><li class="L4"><span class="pln">    $scope</span><span class="pun">.</span><span class="pln">master </span><span class="pun">=</span><span class="pln"> angular</span><span class="pun">.</span><span class="pln">copy</span><span class="pun">(</span><span class="pln">user</span><span class="pun">);</span></li><li class="L5"><span class="pln">  </span><span class="pun">};</span></li><li class="L6"><span class="pln">&nbsp;</span></li><li class="L7"><span class="pln">  $scope</span><span class="pun">.</span><span class="pln">reset </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">function</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span></li><li class="L8"><span class="pln">    $scope</span><span class="pun">.</span><span class="pln">user </span><span class="pun">=</span><span class="pln"> angular</span><span class="pun">.</span><span class="pln">copy</span><span class="pun">(</span><span class="pln">$scope</span><span class="pun">.</span><span class="pln">master</span><span class="pun">);</span></li><li class="L9"><span class="pln">  </span><span class="pun">};</span></li><li class="L0"><span class="pln">&nbsp;</span></li><li class="L1"><span class="pln">  $scope</span><span class="pun">.</span><span class="pln">isUnchanged </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">function</span><span class="pun">(</span><span class="pln">user</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span></li><li class="L2"><span class="pln">    </span><span class="kwd">return</span><span class="pln"> angular</span><span class="pun">.</span><span class="pln">equals</span><span class="pun">(</span><span class="pln">user</span><span class="pun">,</span><span class="pln"> $scope</span><span class="pun">.</span><span class="pln">master</span><span class="pun">);</span></li><li class="L3"><span class="pln">  </span><span class="pun">};</span></li><li class="L4"><span class="pln">&nbsp;</span></li><li class="L5"><span class="pln">  $scope</span><span class="pun">.</span><span class="pln">reset</span><span class="pun">();</span></li><li class="L6"><span class="pun">}</span></li></ol></pre>

</div>
</div></div>
<h3>效果</h3>
<div class="well">
	<iframe src="./13.AngularJS 表单(Forms)_files/9.html"></iframe>
</div>

<hr>
<h2 id="自定义验证">自定义验证</h2>
<p>Angular提供了一些常用的html5输入控件的验证实现：(<a href="http://www.angularjs.net.cn/tutorial/api/ng.directive:input.text"><code><span class="pln">text</span></code></a>, <a href="http://www.angularjs.net.cn/tutorial/api/ng.directive:input.number"><code><span class="pln">number</span></code></a>, <a href="http://www.angularjs.net.cn/tutorial/api/ng.directive:input.url"><code><span class="pln">url</span></code></a>, <a href="http://www.angularjs.net.cn/tutorial/api/ng.directive:input.email"><code><span class="pln">email</span></code></a>, <a href="http://www.angularjs.net.cn/tutorial/api/ng.directive:input.radio"><code><span class="pln">radio</span></code></a>, <a href="http://www.angularjs.net.cn/tutorial/api/ng.directive:input.checkbox"><code><span class="pln">checkbox</span></code></a>), 以及一些用于验证的指令 (<code><span class="pln">required</span></code>, <code><span class="pln">pattern</span></code>, <code><span class="pln">minlength</span></code>, <code><span class="pln">maxlength</span></code>, <code><span class="pln">min</span></code>, <code><span class="pln">max</span></code>).</p>
<p>定义你自己的验证器可以首先定义一个指令，这个指令为 'ngModel' <a href="http://www.angularjs.net.cn/tutorial/api/ng.directive:ngModel.NgModelController"><code><span class="pun">控制器</span></code></a>添加自定义验证方法。
我们通过指定一个依赖来获得对这个控制器的引用，从下面的例子中可以看出。</p>
<p>我们的验证在两个时机触发：</p>
<ul>
<li><p><strong>数据到视图的更新</strong> -
任何时候，受约束的模型改变时，所有在<a href="http://www.angularjs.net.cn/tutorial/api/ng.directive:ngModel.NgModelController#properties_$formatters"><code><span class="typ">NgModelController</span><span class="com">#$formatters</span></code></a>数组中的方法会被管道式调用（即：一个接一个的调用方法），这样一来，所有的方法都有机会对值来进行格式化并改变表单和控件的有效性状态，这将通过调用<a href="http://www.angularjs.net.cn/tutorial/api/ng.directive:ngModel.NgModelController#methods_$setvalidity"><code><span class="typ">NgModelController</span><span class="com">#$setValidity</span></code></a>来实现。</p>
</li>
<li><p><strong>视图到数据的更新</strong> -
类似的，当用户与一个控件交互时，调用<a href="http://www.angularjs.net.cn/tutorial/api/ng.directive:ngModel.NgModelController#methods_$setviewvalue"><code><span class="typ">NgModelController</span><span class="com">#$setViewValue</span></code></a>.
这又反过来管式调用了所有在<a href="http://www.angularjs.net.cn/tutorial/api/ng.directive:ngModel.NgModelController#properties_$parsers"><code><span class="typ">NgModelController</span><span class="com">#$parsers</span></code></a>数组中的方法，这样一来，所有的方法都有机会对值来进行转换并改变表单和控件的有效性状态，通过<a href="http://www.angularjs.net.cn/tutorial/api/ng.directive:ngModel.NgModelController#methods_$setvalidity"><code><span class="typ">NgModelController</span><span class="com">#$setValidity</span></code></a>来实现。</p>
</li>
</ul>
<p>下面的示例中我们创建了两个指令。</p>
<ul>
<li>第一个指令是 'integer' 整形数字，它验证了输入是否是一个合法的整形数字。
例如，'1.23'是一个非法值，因为它包含小数部分。
注意，我们并没有对数组进行压栈操作，而是插入数组的开头。
这是因为我们希望指令能成为第一个解析和处理被控制的值，而不希望在我们执行验证前，值已经在其他环节被转换成了数字。</li>
<li>第二个指令是 'smart-float' 智能浮点数。
它能解析 '1.2' 和 '1,2' 并将其转换成合法的浮点数 '1.2'.
注意，我们此时不能在HTML5的浏览器中使用 'number' 类型，因为在这种情况下，浏览器不会允许用户输入像 '1,2' 这种被认为是不合法的数字。</li>
</ul>
<h3>源码</h3>

<div class="tabbable" role="tablist">
<ul class="nav nav-tabs">
<li class="active"><a href="http://www.angularjs.net.cn/tutorial/4.html#html4" role="tab" data-toggle="tab">index.html</a></li>
<li><a href="http://www.angularjs.net.cn/tutorial/4.html#js4" role="tab" data-toggle="tab">script.js</a></li>
</ul>
<div class="tab-content">
<div class="tab-pane active" title="index.html" id="html4">
<pre class="prettyprint linenums ng-binding" ng-set-text="index.html-244" ng-html-wrap="form-example1 angular.js script.js"><ol class="linenums"><li class="L0"><span class="dec">&lt;!doctype html&gt;</span></li><li class="L1"><span class="tag">&lt;html</span><span class="pln"> </span><span class="atn">ng-app</span><span class="pun">=</span><span class="atv">"form-example1"</span><span class="tag">&gt;</span></li><li class="L2"><span class="pln">  </span><span class="tag">&lt;head&gt;</span></li><li class="L3"><span class="pln">    </span><span class="tag">&lt;script</span><span class="pln"> </span><span class="atn">src</span><span class="pun">=</span><span class="atv">"http://code.angularjs.org/1.2.25/angular.min.js"</span><span class="tag">&gt;&lt;/script&gt;</span></li><li class="L4"><span class="pln">    </span><span class="tag">&lt;script</span><span class="pln"> </span><span class="atn">src</span><span class="pun">=</span><span class="atv">"script.js"</span><span class="tag">&gt;&lt;/script&gt;</span></li><li class="L5"><span class="pln">  </span><span class="tag">&lt;/head&gt;</span></li><li class="L6"><span class="pln">  </span><span class="tag">&lt;body&gt;</span></li><li class="L7"><span class="pln">    </span><span class="tag">&lt;div</span><span class="pln"> </span><span class="atn">ng-controller</span><span class="pun">=</span><span class="atv">"Controller"</span><span class="tag">&gt;</span></li><li class="L8"><span class="pln">      </span><span class="tag">&lt;form</span><span class="pln"> </span><span class="atn">name</span><span class="pun">=</span><span class="atv">"form"</span><span class="pln"> </span><span class="atn">class</span><span class="pun">=</span><span class="atv">"css-form"</span><span class="pln"> </span><span class="atn">novalidate</span><span class="tag">&gt;</span></li><li class="L9"><span class="pln">        </span><span class="tag">&lt;div&gt;</span></li><li class="L0"><span class="pln">          大小 (整数 0 - 10):</span></li><li class="L1"><span class="pln">          </span><span class="tag">&lt;input</span><span class="pln"> </span><span class="atn">type</span><span class="pun">=</span><span class="atv">"number"</span><span class="pln"> </span><span class="atn">ng-model</span><span class="pun">=</span><span class="atv">"size"</span><span class="pln"> </span><span class="atn">name</span><span class="pun">=</span><span class="atv">"size"</span></li><li class="L2"><span class="pln">                 </span><span class="atn">min</span><span class="pun">=</span><span class="atv">"0"</span><span class="pln"> </span><span class="atn">max</span><span class="pun">=</span><span class="atv">"10"</span><span class="pln"> </span><span class="atn">integer</span><span class="pln"> </span><span class="tag">/&gt;&lt;br</span><span class="pln"> </span><span class="tag">/&gt;</span></li><li class="L3"><span class="pln">          </span><span class="tag">&lt;span</span><span class="pln"> </span><span class="atn">ng-show</span><span class="pun">=</span><span class="atv">"form.size.$error.integer"</span><span class="tag">&gt;</span><span class="pln">这是无效的数字!</span><span class="tag">&lt;/span&gt;</span></li><li class="L4"><span class="pln">          </span><span class="tag">&lt;span</span><span class="pln"> </span><span class="atn">ng-show</span><span class="pun">=</span><span class="atv">"form.size.$error.min || form.size.$error.max"</span><span class="tag">&gt;</span></li><li class="L5"><span class="pln">            值必需在0到10之间!</span><span class="tag">&lt;/span&gt;</span></li><li class="L6"><span class="pln">        </span><span class="tag">&lt;/div&gt;</span></li><li class="L7"><span class="pln">    </span></li><li class="L8"><span class="pln">        </span><span class="tag">&lt;div&gt;</span></li><li class="L9"><span class="pln">          长度 (浮点):</span></li><li class="L0"><span class="pln">          </span><span class="tag">&lt;input</span><span class="pln"> </span><span class="atn">type</span><span class="pun">=</span><span class="atv">"text"</span><span class="pln"> </span><span class="atn">ng-model</span><span class="pun">=</span><span class="atv">"length"</span><span class="pln"> </span><span class="atn">name</span><span class="pun">=</span><span class="atv">"length"</span><span class="pln"> </span><span class="atn">smart-float</span><span class="pln"> </span><span class="tag">/&gt;</span></li><li class="L1"><span class="pln">          </span><span class="tag">&lt;br</span><span class="pln"> </span><span class="tag">/&gt;</span></li><li class="L2"><span class="pln">          </span><span class="tag">&lt;span</span><span class="pln"> </span><span class="atn">ng-show</span><span class="pun">=</span><span class="atv">"form.length.$error.float"</span><span class="tag">&gt;</span></li><li class="L3"><span class="pln">            这是无效的浮点数!</span><span class="tag">&lt;/span&gt;</span></li><li class="L4"><span class="pln">        </span><span class="tag">&lt;/div&gt;</span></li><li class="L5"><span class="pln">      </span><span class="tag">&lt;/form&gt;</span></li><li class="L6"><span class="pln">    </span><span class="tag">&lt;/div&gt;</span></li><li class="L7"><span class="pln">  </span><span class="tag">&lt;/body&gt;</span></li><li class="L8"><span class="tag">&lt;/html&gt;</span></li></ol></pre>

</div>
<div class="tab-pane" title="script.js" id="js4">
<pre class="prettyprint linenums"><ol class="linenums"><li class="L0"><span class="kwd">var</span><span class="pln"> app </span><span class="pun">=</span><span class="pln"> angular</span><span class="pun">.</span><span class="kwd">module</span><span class="pun">(</span><span class="str">'form-example1'</span><span class="pun">,</span><span class="pln"> </span><span class="pun">[]);</span></li><li class="L1"><span class="pln">&nbsp;</span></li><li class="L2"><span class="kwd">var</span><span class="pln"> INTEGER_REGEXP </span><span class="pun">=</span><span class="pln"> </span><span class="str">/^\-?\d+$/</span><span class="pun">;</span></li><li class="L3"><span class="pln">app</span><span class="pun">.</span><span class="pln">directive</span><span class="pun">(</span><span class="str">'integer'</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">function</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span></li><li class="L4"><span class="pln">  </span><span class="kwd">return</span><span class="pln"> </span><span class="pun">{</span></li><li class="L5"><span class="pln">    </span><span class="kwd">require</span><span class="pun">:</span><span class="pln"> </span><span class="str">'ngModel'</span><span class="pun">,</span></li><li class="L6"><span class="pln">    link</span><span class="pun">:</span><span class="pln"> </span><span class="kwd">function</span><span class="pun">(</span><span class="pln">scope</span><span class="pun">,</span><span class="pln"> elm</span><span class="pun">,</span><span class="pln"> attrs</span><span class="pun">,</span><span class="pln"> ctrl</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span></li><li class="L7"><span class="pln">      ctrl</span><span class="pun">.</span><span class="pln">$parsers</span><span class="pun">.</span><span class="pln">unshift</span><span class="pun">(</span><span class="kwd">function</span><span class="pun">(</span><span class="pln">viewValue</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span></li><li class="L8"><span class="pln">        </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">INTEGER_REGEXP</span><span class="pun">.</span><span class="pln">test</span><span class="pun">(</span><span class="pln">viewValue</span><span class="pun">))</span><span class="pln"> </span><span class="pun">{</span></li><li class="L9"><span class="pln">          </span><span class="com">// 验证通过</span></li><li class="L0"><span class="pln">          ctrl</span><span class="pun">.</span><span class="pln">$setValidity</span><span class="pun">(</span><span class="str">'integer'</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">true</span><span class="pun">);</span></li><li class="L1"><span class="pln">          </span><span class="kwd">return</span><span class="pln"> viewValue</span><span class="pun">;</span></li><li class="L2"><span class="pln">        </span><span class="pun">}</span><span class="pln"> </span><span class="kwd">else</span><span class="pln"> </span><span class="pun">{</span></li><li class="L3"><span class="pln">          </span><span class="com">// 验证不通过 返回 undefined (不会有模型更新)</span></li><li class="L4"><span class="pln">          ctrl</span><span class="pun">.</span><span class="pln">$setValidity</span><span class="pun">(</span><span class="str">'integer'</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">false</span><span class="pun">);</span></li><li class="L5"><span class="pln">          </span><span class="kwd">return</span><span class="pln"> </span><span class="kwd">undefined</span><span class="pun">;</span></li><li class="L6"><span class="pln">        </span><span class="pun">}</span></li><li class="L7"><span class="pln">      </span><span class="pun">});</span></li><li class="L8"><span class="pln">    </span><span class="pun">}</span></li><li class="L9"><span class="pln">  </span><span class="pun">};</span></li><li class="L0"><span class="pun">});</span></li><li class="L1"><span class="pln">&nbsp;</span></li><li class="L2"><span class="kwd">var</span><span class="pln"> FLOAT_REGEXP </span><span class="pun">=</span><span class="pln"> </span><span class="str">/^\-?\d+((\.|\,)\d+)?$/</span><span class="pun">;</span></li><li class="L3"><span class="pln">app</span><span class="pun">.</span><span class="pln">directive</span><span class="pun">(</span><span class="str">'smartFloat'</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">function</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span></li><li class="L4"><span class="pln">  </span><span class="kwd">return</span><span class="pln"> </span><span class="pun">{</span></li><li class="L5"><span class="pln">    </span><span class="kwd">require</span><span class="pun">:</span><span class="pln"> </span><span class="str">'ngModel'</span><span class="pun">,</span></li><li class="L6"><span class="pln">    link</span><span class="pun">:</span><span class="pln"> </span><span class="kwd">function</span><span class="pun">(</span><span class="pln">scope</span><span class="pun">,</span><span class="pln"> elm</span><span class="pun">,</span><span class="pln"> attrs</span><span class="pun">,</span><span class="pln"> ctrl</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span></li><li class="L7"><span class="pln">      ctrl</span><span class="pun">.</span><span class="pln">$parsers</span><span class="pun">.</span><span class="pln">unshift</span><span class="pun">(</span><span class="kwd">function</span><span class="pun">(</span><span class="pln">viewValue</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span></li><li class="L8"><span class="pln">        </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">FLOAT_REGEXP</span><span class="pun">.</span><span class="pln">test</span><span class="pun">(</span><span class="pln">viewValue</span><span class="pun">))</span><span class="pln"> </span><span class="pun">{</span></li><li class="L9"><span class="pln">          ctrl</span><span class="pun">.</span><span class="pln">$setValidity</span><span class="pun">(</span><span class="str">'float'</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">true</span><span class="pun">);</span></li><li class="L0"><span class="pln">          </span><span class="kwd">return</span><span class="pln"> parseFloat</span><span class="pun">(</span><span class="pln">viewValue</span><span class="pun">.</span><span class="pln">replace</span><span class="pun">(</span><span class="str">','</span><span class="pun">,</span><span class="pln"> </span><span class="str">'.'</span><span class="pun">));</span></li><li class="L1"><span class="pln">        </span><span class="pun">}</span><span class="pln"> </span><span class="kwd">else</span><span class="pln"> </span><span class="pun">{</span></li><li class="L2"><span class="pln">          ctrl</span><span class="pun">.</span><span class="pln">$setValidity</span><span class="pun">(</span><span class="str">'float'</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">false</span><span class="pun">);</span></li><li class="L3"><span class="pln">          </span><span class="kwd">return</span><span class="pln"> </span><span class="kwd">undefined</span><span class="pun">;</span></li><li class="L4"><span class="pln">        </span><span class="pun">}</span></li><li class="L5"><span class="pln">      </span><span class="pun">});</span></li><li class="L6"><span class="pln">    </span><span class="pun">}</span></li><li class="L7"><span class="pln">  </span><span class="pun">};</span></li><li class="L8"><span class="pun">});</span></li></ol></pre>

</div>
</div></div>

<h3 id="自定义验证_demo">效果</h3>
<div class="well">

</div>
<hr>
<h2 id="实现自定义form控件">实现自定义form控件(使用 'ngModel')</h2>
<p>Angular实现了所有基本的HTML表单控件((<a href="http://www.angularjs.net.cn/tutorial/api/ng.directive:input"><code><span class="pln">input</span></code></a>, <a href="http://www.angularjs.net.cn/tutorial/api/ng.directive:select"><code><span class="kwd">select</span></code></a>, <a href="http://www.angularjs.net.cn/tutorial/api/ng.directive:textarea"><code><span class="pln">textarea</span></code></a>)，它们在大多数情况下都很有效。
然而，如果你需要更多的灵活性，你可以使用指令来实现你的自定义表单控件。</p>
<p>为了能让自定义控件能够与'ngModel'正常工作，达到双向绑定的效果，它需要：</p>
<ul>
<li>实现 '$render' 方法，它负责在数据传递给方法<a href="http://www.angularjs.net.cn/tutorial/api/ng.directive:ngModel.NgModelController#properties_$formatters"><code><span class="typ">NgModelController</span><span class="com">#$formatters</span></code></a>之后渲染数据。</li>
<li>调用 '$setViewValue' 方法，在任何用户与控件交互后，模型需要更新的时候调用。这通常在一个DOM事件监听器里完成。</li>
</ul>
<p>查看 <a href="http://www.angularjs.net.cn/tutorial/guide/directive">$compileProvider.directive</a> 获得更多的信息。</p>
<p>接下来的例子展示了如何为一个可编辑元素添加双向绑定。</p>
<h3 id="实现自定义form控件_source">Source</h3>

<div class="tabbable" role="tablist">
<ul class="nav nav-tabs">
<li class="active"><a href="http://www.angularjs.net.cn/tutorial/4.html#html5" role="tab" data-toggle="tab">index.html</a></li>
<li><a href="http://www.angularjs.net.cn/tutorial/4.html#js5" role="tab" data-toggle="tab">script.js</a></li>
</ul>

<div class="tab-content">
<div class="tab-pane active" title="index.html" id="html5">
<pre class="prettyprint linenums ng-binding" ng-set-text="index.html-246" ng-html-wrap="form-example2 angular.js script.js"><ol class="linenums"><li class="L0"><span class="dec">&lt;!doctype html&gt;</span></li><li class="L1"><span class="tag">&lt;html</span><span class="pln"> </span><span class="atn">ng-app</span><span class="pun">=</span><span class="atv">"form-example2"</span><span class="tag">&gt;</span></li><li class="L2"><span class="pln">  </span><span class="tag">&lt;head&gt;</span></li><li class="L3"><span class="pln">    </span><span class="tag">&lt;script</span><span class="pln"> </span><span class="atn">src</span><span class="pun">=</span><span class="atv">"http://code.angularjs.org/1.2.25/angular.min.js"</span><span class="tag">&gt;&lt;/script&gt;</span></li><li class="L4"><span class="pln">    </span><span class="tag">&lt;script</span><span class="pln"> </span><span class="atn">src</span><span class="pun">=</span><span class="atv">"script.js"</span><span class="tag">&gt;&lt;/script&gt;</span></li><li class="L5"><span class="pln">  </span><span class="tag">&lt;/head&gt;</span></li><li class="L6"><span class="pln">  </span><span class="tag">&lt;body&gt;</span></li><li class="L7"><span class="pln">    </span><span class="tag">&lt;div</span><span class="pln"> </span><span class="atn">contentEditable</span><span class="pun">=</span><span class="atv">"true"</span><span class="pln"> </span><span class="atn">ng-model</span><span class="pun">=</span><span class="atv">"content"</span><span class="pln"> </span><span class="atn">title</span><span class="pun">=</span><span class="atv">"Click to edit"</span><span class="tag">&gt;</span><span class="pln">Some</span><span class="tag">&lt;/div&gt;</span></li><li class="L8"><span class="pln">    </span><span class="tag">&lt;pre&gt;</span><span class="pln">model = </span><span class="tag">&lt;/pre&gt;</span></li><li class="L9"><span class="pln">    </span></li><li class="L0"><span class="pln">    </span><span class="tag">&lt;style</span><span class="pln"> </span><span class="atn">type</span><span class="pun">=</span><span class="atv">"text/css"</span><span class="tag">&gt;</span></li><li class="L1"><span class="pln">      div</span><span class="pun">[</span><span class="pln">contentEditable</span><span class="pun">]</span><span class="pln"> </span><span class="pun">{</span></li><li class="L2"><span class="pln">        cursor</span><span class="pun">:</span><span class="pln"> pointer</span><span class="pun">;</span></li><li class="L3"><span class="pln">        background</span><span class="pun">-</span><span class="pln">color</span><span class="pun">:</span><span class="pln"> </span><span class="com">#D0D0D0;</span></li><li class="L4"><span class="pln">      </span><span class="pun">}</span></li><li class="L5"><span class="pln">    </span><span class="tag">&lt;/style&gt;</span></li><li class="L6"><span class="pln">  </span><span class="tag">&lt;/body&gt;</span></li><li class="L7"><span class="tag">&lt;/html&gt;</span></li></ol></pre>

</div>
<div class="tab-pane" title="script.js" id="js5">
<pre class="prettyprint linenums" ng-set-text="script.js-245"><ol class="linenums"><li class="L0"><span class="pln">angular</span><span class="pun">.</span><span class="kwd">module</span><span class="pun">(</span><span class="str">'form-example2'</span><span class="pun">,</span><span class="pln"> </span><span class="pun">[]).</span><span class="pln">directive</span><span class="pun">(</span><span class="str">'contenteditable'</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">function</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span></li><li class="L1"><span class="pln">  </span><span class="kwd">return</span><span class="pln"> </span><span class="pun">{</span></li><li class="L2"><span class="pln">    </span><span class="kwd">require</span><span class="pun">:</span><span class="pln"> </span><span class="str">'ngModel'</span><span class="pun">,</span></li><li class="L3"><span class="pln">    link</span><span class="pun">:</span><span class="pln"> </span><span class="kwd">function</span><span class="pun">(</span><span class="pln">scope</span><span class="pun">,</span><span class="pln"> elm</span><span class="pun">,</span><span class="pln"> attrs</span><span class="pun">,</span><span class="pln"> ctrl</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span></li><li class="L4"><span class="pln">      </span><span class="com">// 视图 -&gt; 模型</span></li><li class="L5"><span class="pln">      elm</span><span class="pun">.</span><span class="pln">on</span><span class="pun">(</span><span class="str">'blur'</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">function</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span></li><li class="L6"><span class="pln">        scope</span><span class="pun">.</span><span class="pln">$apply</span><span class="pun">(</span><span class="kwd">function</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span></li><li class="L7"><span class="pln">          ctrl</span><span class="pun">.</span><span class="pln">$setViewValue</span><span class="pun">(</span><span class="pln">elm</span><span class="pun">.</span><span class="pln">html</span><span class="pun">());</span></li><li class="L8"><span class="pln">        </span><span class="pun">});</span></li><li class="L9"><span class="pln">      </span><span class="pun">});</span></li><li class="L0"><span class="pln">&nbsp;</span></li><li class="L1"><span class="pln">      </span><span class="com">// 模型 -&gt; 视图</span></li><li class="L2"><span class="pln">      ctrl</span><span class="pun">.</span><span class="pln">$render </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">function</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span></li><li class="L3"><span class="pln">        elm</span><span class="pun">.</span><span class="pln">html</span><span class="pun">(</span><span class="pln">ctrl</span><span class="pun">.</span><span class="pln">$viewValue</span><span class="pun">);</span></li><li class="L4"><span class="pln">      </span><span class="pun">};</span></li><li class="L5"><span class="pln">&nbsp;</span></li><li class="L6"><span class="pln">      </span><span class="com">// 从DOM中初始化数据</span></li><li class="L7"><span class="pln">      ctrl</span><span class="pun">.</span><span class="pln">$setViewValue</span><span class="pun">(</span><span class="pln">elm</span><span class="pun">.</span><span class="pln">html</span><span class="pun">());</span></li><li class="L8"><span class="pln">    </span><span class="pun">}</span></li><li class="L9"><span class="pln">  </span><span class="pun">};</span></li><li class="L0"><span class="pun">});</span></li></ol></pre>
</div>
</div></div>

<h3>效果</h3>
<div class="well ">

</div>

		
	<div class="ad1">	
<script async="" src="http://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<!-- 336 x 280 -->
<ins class="adsbygoogle" style="display:inline-block;width:336px;height:280px" data-ad-client="ca-pub-6117966252207595" data-ad-slot="9942648348"></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
</div>	
	
		</div>
	</div>
</div>
<footer>
	<p>Copyright © 2014 - 2018 <a href="http://www.angularjs.net.cn/">AngularJS中文网</a>, <a href="http://www.miitbeian.gov.cn/" target="_blank">粤ICP备15074038号-4</a>, All Rights Reserved.

</p>
</footer>
<script type="text/javascript">
    /*图+推广*/
    /*建议投放在200*300以上的图片*/
    var cpro_id = "u1948815";
</script>
<script type="text/javascript" src="./13.AngularJS 表单(Forms)_files/i.js.下载"></script>


<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?12ec03a62d55d8fb4b144b14ccedecec";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>


<script src="./13.AngularJS 表单(Forms)_files/jquery.js.下载"></script>
<script src="./13.AngularJS 表单(Forms)_files/common.js.下载"></script>
<script src="./13.AngularJS 表单(Forms)_files/bootstrap.min.js.下载"></script>

</body></html>